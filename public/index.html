<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>SMS</title>
  <meta name="description" content="sms">
</head>

<style>
span {
  color: #cc2400;
}
</style>

<body>

  <h1>Auth User</h1>

  <h2>First: auth weibo(1: signup  date < 2013-09-01, 2: followers count > 50, 3: repost our feed)</h2>
  <p>
    weibo Domain ID:
    <input id="weiboId"></input>
    <button id="check">check</button>
    <span id="weiboResult"></span>
  </p>

  <h2>Second: auth mobile sms code</h2>
  <p>
    mobile number: 
    <input name="mobile" id="mobile"></input>
    <button id="submit">get sms</button>
    <span id="mobileResult"></span>
  </p>
  <p>
    code:
    <input name="code" id="code"></input>
    <button id="verify">verify</button>
    <span id="codeResult"></span>
  </p>
</body>
</html>

<script type="application/javascript" src="/javascripts/jquery.js"></script>

<script>
$(function(){

  var $weiboResult = $("#weiboResult");

  $("#check").click(function(){
    var weiboId = $("#weiboId").val();
    if (weiboId == ""){
      $weiboResult.text("pls input your weibo id");
      return;
    }
    $.ajax({
      url: "/check_weibo",
      type: "POST",
      data: { weibo: weiboId },
      success: function(ret){
        if (ret.code)
          $weiboResult.text("check Success");
        else
          $weiboResult.text(ret.error);
      }
    });
  });


  var $mobileResult = $("#mobileResult");

  $("#submit").click(function(){
    var mobile = $("#mobile").val();
    if (mobile == ""){
      $mobileResult.text("pls input your mobile number!");
      return;
    }
    $.ajax({
      url: "/send_sms",
      type: "POST",
      data: { mobile: mobile },
      success: function(ret){
        if (ret.code)
          $mobileResult.text('have send sms code to your mobile, pls check it');
        else
          $mobileResult.text(ret.error);
      }
    });
  });

  var $codeResult = $("#codeResult");

  $("#verify").click(function(){
    var code = $("#code").val();
    var mobile = $("#mobile").val();
    if (code == ""){
      $codeResult.text("pls input code from your sms");
      return;
    }
    $.ajax({
      url: "/verify",
      type: "POST",
      data: { code: code, mobile: mobile },
      success: function(ret){
        if (ret.code)
          $codeResult.text("verify success");
        else
          $codeResult.text(ret.error);
      }
    });
  });
});
</script>



